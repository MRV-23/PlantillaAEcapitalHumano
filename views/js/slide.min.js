function actualizarCajaSlide(){let e=new FormData;e.append("actualizarArrastrarImagen",!0),$.ajax({url:ruta_server+"controllers/AjaxGestorImagenes.php",method:"POST",data:e,cache:!1,contentType:!1,processData:!1,dataType:"json",success:function(e){$("#recargarContenedorSlide").html(e.carrusel),$("#recargarContenedorTextoSlide").html(e.texto)}})}function eliminarItems(e){1==$(".eliminarItemSlide").length&&$("#columnasSlide").css({height:"200px"});let a=e.parent().attr("id"),t=e.attr("ruta");e.parent().remove();let r=new FormData;r.append("idSlide",a),r.append("rutaSlide",t),$.ajax({url:ruta_server+"controllers/AjaxGestorImagenes.php",method:"POST",data:r,cache:!1,contentType:!1,processData:!1,success:function(e){actualizarCajaSlide()}}),actualizarNumeracion()}function actualizarNumeracion(){let e=$("#columnasSlide > *").length;for(let a=0;a<e;a++)$("#columnasSlide").children().eq(a).children("span.posicionSlide").text(a+1)}function editarItems(e,a,t="",r=""){let i='<div class="modalSlideCrow" id="modal"><div class="canvasSlideCrow"> <div class="contenedorEditar">  <img src="'+a+'" alt=""><input type="text" class="formulario" name="titulo" id="titulo" placeholder="Titulo" value="'+t+'"><textarea class="formulario" name="formulario" id="descripcion" placeholder="DescripciÃ³n" rows="4">'+r+'</textarea><button type="button" class="btn btn-success" id="guardarItem">Guardar</button>  </div>   <span class="modal__botonSlideCrow" id="modal__boton"></span>  </div></div>';$("body").append(i),$("#targetImagenCrow,#modal__boton,#descripcionCrow").css({display:"none"}),$("#targetImagenCrow,#modal__boton,#descripcionCrow").fadeIn(2e3),$("#modal__boton").click(function(){$("#modal").remove()}),$("#modal").click(function(e){e.target===this&&$("#modal").remove()}),$(document).keyup(function(e){27==e.keyCode&&($(document).off("keyup"),$("#modal").remove())}),$("#guardarItem").click(function(){let a=new FormData;a.append("idSlideActualizar",e),a.append("tituloActualizar",$("#titulo").val()),a.append("descripcionActualizar",$("#descripcion").val()),$.ajax({url:ruta_server+"controllers/AjaxGestorImagenes.php",method:"POST",data:a,cache:!1,contentType:!1,processData:!1,success:function(){location.reload()}})})}0==$("#columnasSlide").html()&&$("#columnasSlide").css({height:"200px"}),$("#columnasSlide").on("dragover",function(e){e.preventDefault(),e.stopPropagation(),$("#columnasSlide").css({background:"url("+ruta_server+"views/img/pattern.jpg)"})}),$("#columnasSlide").on("drop",function(e){e.preventDefault(),e.stopPropagation(),$("#columnasSlide").css({background:"white"});var a=e.originalEvent.dataTransfer.files[0];let t=a.size;Number(t)>2e6?$("#columnasSlide").before('<div class="warningCrow">El archivo excede el peso permitido, 2 Mb</div>'):$(".warningCrow").remove();let r=a.type;if("image/jpeg"==r||"image/png"==r?$(".alertaCrow").remove():$("#columnasSlide").before('<div class="warningCrow">El archivo debe ser formato JPG o PNG</div>'),Number(t)<2e6&&"image/jpeg"==r||"image/png"==r){let e=new FormData;e.append("imagenSlide",a),$("#columnasSlide").before('<img src="'+ruta_server+'views/img/status.gif" id="status" class="statusCrow">'),$.ajax({url:ruta_server+"controllers/AjaxGestorImagenes.php",method:"POST",data:e,cache:!1,contentType:!1,processData:!1,dataType:"json",success:function(e){$("#status").remove(),e.error?$("#columnasSlide").before('<div class="warningCrow">Error</div>'):($("#columnasSlide").css({height:"auto"}),$("#columnasSlide").append('<li id="'+e.id+'" class="bloqueSlide"><span ruta="'+e.ruta+'" class="eliminarItemSlide"><i class="fa fa-trash" aria-hidden="true"></i></span> <span class="editarItemSlide"><i class="fa fa-pencil" aria-hidden="true"></i></span>  <span class="posicionSlide">'+e.orden+'</span> <img src="'+e.ruta.slice(3)+'" class="handleImg"></li>'),actualizarCajaSlide(),$(".eliminarItemSlide").click(function(){eliminarItems($(this))}),$(".editarItemSlide").click(function(){editarItems($(this).parent().attr("id"),e.ruta.slice(3))})),actualizarNumeracion()}})}}),$(".eliminarItemSlide").click(function(){eliminarItems($(this))}),$(".editarItemSlide").click(function(){let e=$(this).parent().attr("id"),a=new FormData;a.append("idMostrarDatosEditar",e),$.ajax({url:ruta_server+"controllers/AjaxGestorImagenes.php",method:"POST",data:a,cache:!1,contentType:!1,processData:!1,dataType:"json",success:function(a){editarItems(e,a.ruta.slice(3),a.titulo,a.descripcion)}})});let almacenarOrdenId=new Array,ordenItem=new Array;$("#ordenarSlide").click(function(){$("#columnasSlide").css({cursor:"move"}),$("#columnasSlide span").hide(),$("#columnasSlide").sortable({disabled:!1,revert:!0,connectWith:".bloqueSlide",handle:".handleImg",stop:function(e){for(let a=0;a<$("#columnasSlide li").length;a++)almacenarOrdenId[a]=e.target.children[a].id,ordenItem[a]=a+1}}),$("#ordenarSlide").hide(),$("#guardarSlide").show()}),$("#guardarSlide").click(function(){for(var e=0;e<$("#columnasSlide li").length;e++){let a=new FormData,t=!1;a.append("actualizarOrdenSlide",almacenarOrdenId[e]),a.append("actualizarOrdenItem",ordenItem[e]),e==$("#columnasSlide li").length-1&&(t=!0),$.ajax({url:ruta_server+"controllers/AjaxGestorImagenes.php",method:"POST",data:a,cache:!1,contentType:!1,processData:!1,success:function(e){1==t&&actualizarCajaSlide()}})}actualizarNumeracion(),$("#columnasSlide").sortable("disable"),$("#columnasSlide").css({cursor:"default"}),$("#ordenarSlide").show(),$("#guardarSlide").hide(),$("#columnasSlide span").show()});